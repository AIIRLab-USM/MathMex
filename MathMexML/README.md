# MathMexML: ARQMath Triplet Extraction & MPNet Training Pipeline

This folder contains scripts and data for extracting training triplets from the ARQMath dataset and training a math-aware MPNet model using the TeXBLEU tokenizer.

---

## 📁 Folder Structure

```
MathMexML/
│
├── ARQMathData/
│   ├── Posts.V1.3.xml
│   └── arqmath_triplets.pkl         # Generated by extract_arqmath_triplets.py
├── tokenizer.json                   # From TeXBLEU repo
├── extract_arqmath_triplets.py      # Script to extract triplets
├── train_texbleu_mpnet.py           # Script to train MPNet model
└── README.md
```

---

## 🛠️ Requirements

- Python 3.8+
- [torch](https://pytorch.org/)
- [transformers](https://huggingface.co/docs/transformers/index)
- [lxml](https://lxml.de/)
- [tqdm](https://tqdm.github.io/)
- `tokenizer.json` from [TeXBLEU](https://github.com/KyuDan1/TeXBLEU)
- ARQMath dataset (download from [ARQMath Data](https://www.cs.rit.edu/~dprl/ARQMath/data.html))

**Install dependencies:**
```sh
pip install torch transformers lxml tqdm
```

---

## 🚀 Usage

### 1. Prepare Data

- Download `Posts.V1.3.xml` and place it in `ARQMathData/`.
- Place `tokenizer.json` in the root of this folder.

### 2. Extract Triplets

```sh
python extract_arqmath_triplets.py
```
This will create `ARQMathData/arqmath_triplets.pkl`.

### 3. Train the Model

```sh
python train_texbleu_mpnet.py
```
This will save the trained model and tokenizer in `./texbleu-mpnet/`.

---

## 📦 Output

- `ARQMathData/arqmath_triplets.pkl`: List of (question, positive answer, negative answer) triplets.
- `texbleu-mpnet/`: Folder containing the trained MPNet model and tokenizer.

---

## 📝 Notes

- The extraction script uses only the `Posts.V1.3.xml` file. For higher-quality triplets, consider using ARQMath relevance judgements.
- The training script uses triplet margin loss for contrastive learning.
- You can integrate the trained model into your backend for math-aware semantic search.

---

## 🔗 References

- [TeXBLEU Tokenizer](https://github.com/KyuDan1/TeXBLEU)
- [ARQMath Dataset](https://www.cs.rit.edu/~dprl/ARQMath/)
